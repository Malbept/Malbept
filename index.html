
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hamster Kombat</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAA/4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEREQAAAAAAEAAAEAAAAAEAAAABAAAAEAAAAAAQAAAQAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAP+AAAH/gAAB/4AAAf+AAAP/AAAB/4AAA/+AAAP/gAAD/4AAA/+AAAP/wAAD/8AAA//gAAP/4AAA/+AAAP/gAAD/4AA" type="image/x-icon">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Chart.js -->
</head>
<body>
    <div id="top-stats">
        <div id="level-info">
            <span id="level-display">GOLD 1/27</span>
            <button id="level-details-btn" class="hk-button" onclick="showLevelDetails()">‚ÑπÔ∏è</button>
            <div id="level-progress"></div>
            <span id="profit-per-hour">0</span>
        </div>
        <button id="settings-button" onclick="showOther()">‚öôÔ∏è</button>
    </div>
    <div id="main-content">
        <button class="back-button hk-button" onclick="goBack()" style="display: none;">–ù–∞–∑–∞–¥ ‚¨ÖÔ∏è</button>
        <div id="tap-container">
            <div id="tap-button">
                <span>üòà</span>
                <div id="energy-counter">100/100</div>
            </div>
        </div>
    </div>
    <div id="bottom-bar" class="nav-bar">
        <div style="display: flex; flex: 1;">
            <button class="nav-button active" data-action="showMain">
                <span>–ë–∏—Ä–∂–∞</span>
            </button>
            <button class="nav-button" data-action="showGames">
                <span>–ö–∞–∑–∏–Ω–æ</span>
            </button>
            <button class="nav-button" data-action="showQuests">
                <span>–ö–≤–µ—Å—Ç—ã üìã</span>
            </button>
            <button class="nav-button" data-action="showFriends">
                <span>–î—Ä—É–∑—å—è</span>
            </button>
            <button class="nav-button" data-action="showBonuses">
                <span>–ë–æ–Ω—É—Å—ã üéÅ</span>
            </button>
            <button class="nav-button" data-action="showShop">
                <span>–ú–∞–≥–∞–∑–∏–Ω üè¨</span>
            </button>
        </div>
        <div style="display: flex; flex: 1; justify-content: flex-end;">
            <button class="nav-button" data-action="showBoosts">
                <span>–ë—É—Å—Ç</span>
            </button>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="settings.js"></script>
    <script src="promo-data.js"></script>
    <script src="promocode.js"></script>
    <script src="pets.js"></script>
    <script src="real_estate.js"></script>
    <script src="movables.js"></script>
    <script src="upgrades.js"></script>
    <script src="boosts.js"></script>
    <script src="game-mini.js"></script>
    <script src="ui-main.js"></script>
    <script src="ui-main2.js"></script>
    <script src="ui-main3.js"></script>
    <script src="ui-main4.js"></script>
    <script src="utils.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const isTelegram = window.Telegram && window.Telegram.WebApp;
            if (isTelegram) {
                try {
                    window.Telegram.WebApp.ready();
                    window.Telegram.WebApp.expand();
                    const user = window.Telegram.WebApp.initDataUnsafe.user;
                    window.profile.username = user ? (user.username || user.first_name || '–ê–Ω–æ–Ω–∏–º') : '–ê–Ω–æ–Ω–∏–º';
                    window.showNotification(`–ü—Ä–∏–≤–µ—Ç, ${window.profile.username}! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üòà`);
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –º–µ—Ç–æ–¥–∞ Telegram API:', e);
                    window.profile.username = '–ê–Ω–æ–Ω–∏–º';
                    window.showNotification('–ü—Ä–∏–≤–µ—Ç, –ê–Ω–æ–Ω–∏–º! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üòà');
                }
            } else {
                console.warn('Telegram WebApp SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –±–µ–∑ Telegram.');
                window.profile.username = '–ê–Ω–æ–Ω–∏–º';
                window.showNotification('–ü—Ä–∏–≤–µ—Ç, –ê–Ω–æ–Ω–∏–º! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üòà');
            }
            loadProfile();
            updateProfile();
            applyTheme();
            window.calculateProfit();
            document.getElementById('tap-button').addEventListener('click', window.clickTapButton);
            function bindNavEvents() {
                document.querySelectorAll('.nav-button').forEach(button => {
                    button.removeEventListener('click', handleNavClick);
                    button.addEventListener('click', handleNavClick);
                });
            }
            function handleNavClick(event) {
                const button = event.target.closest('.nav-button');
                const action = button.getAttribute('data-action');
                console.log('Clicked button with action:', action);
                document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                if (action && window[action]) {
                    window[action]();
                } else {
                    console.error(`Function ${action} is not defined.`);
                }
            }
            bindNavEvents();
            window.goBack = function() {
                if (historyStack.length > 1) {
                    historyStack.pop();
                    const lastSection = historyStack[historyStack.length - 1];
                    if (lastSection === 'main') {
                        showMain();
                    } else {
                        eval(lastSection);
                    }
                } else {
                    showMain();
                }
            };
        });
    </script>
</body>
</html>